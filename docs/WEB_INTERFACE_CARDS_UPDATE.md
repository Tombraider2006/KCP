# ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ –≤ Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

## üéØ –¶–µ–ª—å

–°–¥–µ–ª–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ –≤ web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ **–∏–¥–µ–Ω—Ç–∏—á–Ω—ã–º–∏** –æ—Å–Ω–æ–≤–Ω–æ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é:
- ‚úÖ –¢–µ –∂–µ –ø–æ–ª—è
- ‚úÖ –¢–µ –∂–µ —Å—Ç–∏–ª–∏
- ‚úÖ –¢–∞ –∂–µ –ª–æ–≥–∏–∫–∞
- ‚úÖ –¢–æ–ª—å–∫–æ –∫–Ω–æ–ø–∫–∞ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å"
- ‚úÖ –ó–≤—É–∫–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

---

## üé® –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –¥–∏–∑–∞–π–Ω–µ

### 1. –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ - —Ç–µ–º–Ω–∞—è —Ç–µ–º–∞

**–§–∞–π–ª:** `src/index.html`

**–ë—ã–ª–æ:** –ë–µ–ª—ã–π —Ñ–æ–Ω, —Å–≤–µ—Ç–ª—ã–µ –ø–æ–ª—è
**–°—Ç–∞–ª–æ:** –¢–µ–º–Ω—ã–π —Ñ–æ–Ω –∫–∞–∫ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

**–¶–≤–µ—Ç–∞:**
- –§–æ–Ω –±–ª–æ–∫–æ–≤: `rgba(0, 212, 255, 0.1)`
- –†–∞–º–∫–∏: `rgba(0, 212, 255, 0.3)`
- –¢–µ–∫—Å—Ç: `#00d4ff`, `#7ea8c8`, `#b8d4e8`
- –ü–æ–ª—è –≤–≤–æ–¥–∞: —Ç–µ–º–Ω—ã–π —Ñ–æ–Ω `rgba(10, 22, 40, 0.5)`

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ä—Ç–æ—á–µ–∫

### –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–∏–Ω—Ç–µ—Ä–∞ —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç:

```html
<div class="printer-card {status}">
    <div class="printer-header">
        <div class="printer-name">–ù–∞–∑–≤–∞–Ω–∏–µ üñ®Ô∏è –¢–∏–ø</div>
        <div class="printer-status">–°–¢–ê–¢–£–°</div>
    </div>
    <div class="printer-info">
        <div class="info-item">
            <span>–ê–¥—Ä–µ—Å:</span>
            <span class="ip-address-large">192.168.1.100</span>
        </div>
        <div class="info-item">
            <span>–°–æ—Å—Ç–æ—è–Ω–∏–µ:</span>
            <span class="state-text">–ü–µ—á–∞—Ç–∞–µ—Ç</span>
        </div>
        <div class="info-item">
            <span>–§–∞–π–ª:</span>
            <span class="file-text">benchy.gcode</span>
        </div>
        <div class="info-item">
            <span>–ü—Ä–æ–≥—Ä–µ—Å—Å:</span>
            <span class="progress-text-large">45%</span>
        </div>
        <div class="info-item">
            <span>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã:</span>
            <span class="temp-text">üå°Ô∏è 210¬∞C / üõèÔ∏è 60¬∞C</span>
        </div>
        <div class="info-item">
            <span>–û–±–Ω–æ–≤–ª–µ–Ω–æ:</span>
            <span class="updated-text">2–º –Ω–∞–∑–∞–¥</span>
        </div>
    </div>
    <div class="printer-actions">
        <button class="btn btn-warning btn-small">üîó –ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
    </div>
</div>
```

---

## üîß –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

**–§–∞–π–ª:** `src/web-interface/app.js`

### –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –∫–∞–∫ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:

```javascript
getStatusTextFromPrinter(printer)  // "–ü–µ—á–∞—Ç–∞–µ—Ç", "–ì–æ—Ç–æ–≤", "–û—à–∏–±–∫–∞"
getStateText(printer)               // –î–µ—Ç–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
getFileName(printer)                // –ò–º—è —Ñ–∞–π–ª–∞ –∏–ª–∏ "‚Äî"
getProgress(printer)                // "45%" –∏–ª–∏ "‚Äî"
getTemperatures(printer)            // "üå°Ô∏è 210¬∞C / üõèÔ∏è 60¬∞C"
formatTime(timestamp)               // "2–º –Ω–∞–∑–∞–¥", "1—á –Ω–∞–∑–∞–¥"
```

### –õ–æ–≥–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:

```javascript
// –ò–∑ printer.data (–¥–∞–Ω–Ω—ã–µ –æ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
const state = printer.data.state || printer.data.print_stats?.state;
const filename = printer.data.filename || printer.data.print_stats?.filename;
const progress = printer.data.progress || calculated;
const temps = printer.data.temps;
```

---

## üîä –ó–≤—É–∫–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### 1. –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –∑–≤—É–∫–æ–≤–æ–π —Ñ–∞–π–ª

```
src/windows-xp-print-complete.mp3 
    ‚Üí src/web-interface/windows-xp-print-complete.mp3
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è

```javascript
// –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
notificationSound = new Audio('windows-xp-print-complete.mp3');
notificationSound.volume = 0.5; // 50% –≥—Ä–æ–º–∫–æ—Å—Ç–∏

// –§—É–Ω–∫—Ü–∏—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
function playCriticalSound() {
    notificationSound.play().catch(err => {
        console.error('Error playing sound:', err);
    });
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ç–∞—Ç—É—Å–æ–≤
function checkCriticalStatus(printerId, newStatus) {
    const oldStatus = previousStatuses.get(printerId);
    const criticalStatuses = ['error', 'paused', 'complete'];
    
    // –ó–≤—É–∫ –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π
    if (criticalStatuses.includes(newStatus) && oldStatus !== newStatus) {
        playCriticalSound();
    }
}
```

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å WebSocket

```javascript
socket.on('printer-status', (data) => {
    const printer = printers.find(p => p.id === data.printerId);
    if (printer) {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫
        checkCriticalStatus(data.printerId, printer.status);
        updatePrinterCard(data.printerId);
    }
});
```

---

## üé® –°—Ç–∏–ª–∏ –∫–∞—Ä—Ç–æ—á–µ–∫

**–§–∞–π–ª:** `src/web-interface/style.css`

### –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–∏–Ω—Ç–µ—Ä–∞:

```css
.printer-card {
    background: rgba(10, 22, 40, 0.7);
    border: 2px solid rgba(0, 212, 255, 0.4);
    border-radius: 10px;
    padding: 18px;
    min-height: 280px;
    display: flex;
    flex-direction: column;
}

.printer-card:hover {
    box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
    border-color: rgba(0, 212, 255, 0.6);
}
```

### –°—Ç–∞—Ç—É—Å –ø—Ä–∏–Ω—Ç–µ—Ä–∞:

```css
.status-printing {
    background: rgba(76, 175, 80, 0.3);
    color: #81c784;
    border: 1px solid rgba(76, 175, 80, 0.6);
}

.status-ready {
    background: rgba(255, 235, 59, 0.3);
    color: #ffd54f;
}

.status-complete,
.status-error,
.status-paused {
    background: rgba(244, 67, 54, 0.3);
    color: #ef5350;
    animation: blink 1.5s infinite; /* –ú–∏–≥–∞–Ω–∏–µ! */
}
```

### –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø–æ–ª—è:

```css
.ip-address-large {
    font-size: 1.1em;
    font-weight: 600;
    color: #00d4ff !important;
}

.progress-text-large {
    font-size: 1.8em; /* –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å! */
    font-weight: 700;
    color: #4CAF50 !important;
}

.progress-100-animation {
    animation: blink 1.5s infinite; /* –ú–∏–≥–∞–Ω–∏–µ –ø—Ä–∏ 100%! */
}

.temp-text {
    color: #ff9800 !important; /* –û—Ä–∞–Ω–∂–µ–≤–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ */
    font-weight: 600;
}
```

---

## üîå API –æ–±–Ω–æ–≤–ª–µ–Ω

**–§–∞–π–ª:** `src/web-server.js`

### Endpoint `/api/printers` —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:

```json
{
  "success": true,
  "count": 2,
  "printers": [
    {
      "id": "printer-1",
      "name": "Ender 3 Pro",
      "type": "klipper",
      "ip": "192.168.1.101",
      "status": "printing",              // ‚Üê –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
      "data": {                          // ‚Üê –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        "state": "printing",
        "filename": "benchy.gcode",
        "progress": 45,
        "temps": {
          "nozzle": 210,
          "bed": 60
        }
      },
      "lastUpdate": "2025-10-10T20:00:00.000Z",
      "connectionType": "HTTP"           // ‚Üê MQTT –∏–ª–∏ HTTP
    }
  ]
}
```

### –ú–µ—Ç–æ–¥ `determineStatus()`:

```javascript
determineStatus(statusData) {
    const state = (statusData.state || '').toLowerCase();
    
    if (state.includes('error')) return 'error';
    if (state.includes('pause')) return 'paused';
    if (state.includes('complete')) return 'complete';
    if (state.includes('print') || state === 'running') return 'printing';
    if (state.includes('ready') || state === 'idle') return 'ready';
    if (state.includes('offline')) return 'offline';
    
    return 'unknown';
}
```

---

## üéØ –§—É–Ω–∫—Ü–∏—è "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å"

**–§–∞–π–ª:** `src/web-interface/app.js`

```javascript
async function testPrinter(printerId) {
    const response = await fetch(`/api/printers/${printerId}/status`);
    const data = await response.json();
    
    if (data.success) {
        alert('‚úÖ –ü—Ä–∏–Ω—Ç–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω!\n\n–°—Ç–∞—Ç—É—Å: ' + data.status.state);
    } else {
        alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏–Ω—Ç–µ—Ä–∞:\n' + data.error);
    }
}
```

–í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ –∫–∞—Ä—Ç–æ—á–∫–∏:
```html
<button onclick="testPrinter('printer-1')">üîó –ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
```

---

## üìù –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----------|----------|
| `src/web-interface/app.js` | +90 —Å—Ç—Ä–æ–∫ | –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∑–≤—É–∫, –ø—Ä–æ–≤–µ—Ä–∫–∞ |
| `src/web-interface/style.css` | ~120 —Å—Ç—Ä–æ–∫ | –¢–µ–º–Ω–∞—è —Ç–µ–º–∞, —Å—Ç–∏–ª–∏ –∫–∞—Ä—Ç–æ—á–µ–∫ |
| `src/web-interface/windows-xp-print-complete.mp3` | –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω | –ó–≤—É–∫–æ–≤–æ–π —Ñ–∞–π–ª |
| `src/web-server.js` | +20 —Å—Ç—Ä–æ–∫ | –ú–µ—Ç–æ–¥ determineStatus(), –æ–±–Ω–æ–≤–ª–µ–Ω API |
| `src/index.html` | ~60 —Å—Ç—Ä–æ–∫ | –¢–µ–º–Ω—ã–µ —Å—Ç–∏–ª–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ |
| `src/translations.js` | +26 —Å—Ç—Ä–æ–∫ | –ü–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è web-—Å–µ—Ä–≤–µ—Ä–∞ (RU/EN) |
| `src/renderer.js` | +3 —Å—Ç—Ä–æ–∫–∏ | –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è currentLang |

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

### –ö–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ —Ç–µ–ø–µ—Ä—å:

1. ‚úÖ **–¢–µ –∂–µ –ø–æ–ª—è** —á—Ç–æ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
2. ‚úÖ **–¢–µ –∂–µ —Å—Ç–∏–ª–∏** (—Ç–µ–º–Ω–∞—è —Ç–µ–º–∞, –≥–æ–ª—É–±—ã–µ –∞–∫—Ü–µ–Ω—Ç—ã)
3. ‚úÖ **–¢–∞ –∂–µ –ª–æ–≥–∏–∫–∞** (getProgress, getTemperatures, formatTime)
4. ‚úÖ **–ú–∏–≥–∞—é—â–∏–µ —Å—Ç–∞—Ç—É—Å—ã** (error, paused, complete, 100% –ø—Ä–æ–≥—Ä–µ—Å—Å)
5. ‚úÖ **–£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å** (1.8em —à—Ä–∏—Ñ—Ç)
6. ‚úÖ **–¶–≤–µ—Ç–Ω—ã–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã** (–æ—Ä–∞–Ω–∂–µ–≤—ã–π)
7. ‚úÖ **–ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å"** —Ä–∞–±–æ—Ç–∞–µ—Ç
8. ‚úÖ **–ó–≤—É–∫ Windows XP** –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö

### Web-—Å–µ—Ä–≤–µ—Ä:

1. ‚úÖ –û—Ç–¥–∞—ë—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. ‚úÖ –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. ‚úÖ –î–æ–±–∞–≤–ª—è–µ—Ç connectionType (MQTT/HTTP)
4. ‚úÖ Timestamp –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–Ω—Ç–µ—Ä–∞

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:** http://localhost:8000
2. **–ö–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤:**
   - ‚úÖ –¢–µ–º–Ω—ã–π —Ñ–æ–Ω
   - ‚úÖ –í—Å–µ –ø–æ–ª—è –≤–∏–¥–Ω—ã (IP, –°–æ—Å—Ç–æ—è–Ω–∏–µ, –§–∞–π–ª, –ü—Ä–æ–≥—Ä–µ—Å—Å, –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã, –û–±–Ω–æ–≤–ª–µ–Ω–æ)
   - ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å –±–æ–ª—å—à–∏–º —à—Ä–∏—Ñ—Ç–æ–º
   - ‚úÖ –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –æ—Ä–∞–Ω–∂–µ–≤—ã–º —Ü–≤–µ—Ç–æ–º
   - ‚úÖ IP –≥–æ–ª—É–±—ã–º —Ü–≤–µ—Ç–æ–º
3. **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç–∞—Ç—É—Å—ã:**
   - ‚úÖ Error/Paused/Complete - –∫—Ä–∞—Å–Ω—ã–µ, –º–∏–≥–∞—é—Ç
   - ‚úÖ –ü—Ä–∏ —Å–º–µ–Ω–µ –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π - –∏–≥—Ä–∞–µ—Ç –∑–≤—É–∫
4. **–ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å":**
   - ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç alert —Å —Å—Ç–∞—Ç—É—Å–æ–º

---

## üîä –ó–≤—É–∫–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è

–ó–≤—É–∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞:
- üî¥ **Error** - –æ—à–∏–±–∫–∞ –ø—Ä–∏–Ω—Ç–µ—Ä–∞
- ‚è∏Ô∏è **Paused** - –ø–∞—É–∑–∞ –ø–µ—á–∞—Ç–∏
- üèÅ **Complete** - –ø–µ—á–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∞

**–ì—Ä–æ–º–∫–æ—Å—Ç—å:** 50% (–º–æ–∂–Ω–æ —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤ –∫–æ–¥–µ)

---

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–í—Å—ë –≤ `docs/`:
- ‚úÖ `docs/WEB_SERVER.md`
- ‚úÖ `docs/WEB_SERVER_QUICKSTART.md`
- ‚úÖ `docs/WEB_SERVER_BUTTONS_FIX.md`
- ‚úÖ `docs/WEB_SERVER_FINAL_FIXES.md`
- ‚úÖ `docs/WEB_INTERFACE_CARDS_UPDATE.md` (—ç—Ç–æ—Ç —Ñ–∞–π–ª)

---

**–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!** üöÄ

